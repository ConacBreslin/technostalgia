{% extends "base.html" %}
{% block content %}

<div class="row">
  <div class="col s12">
    <h4 class="center-align" id="comment-top">{{ page_title }}</h4>
  </div>

  <!-- Card containing technology details -->
  <div class="col s12 m8 offset-m2">
    <div class="card horizontal small hoverable">
      <div class="card-image">
        <img src="{{ technology.technology_image }}" alt="">
      </div>
      <div class="card-stacked">
        <div class="card-content">
          <ul>
            <li><strong>Category: {{ technology.category_name }}</strong></li>
            <li>Name: {{ technology.technology_name }}</li>
            <li>Description: {{ technology.technology_description }}</li>
            <li>Added by: {{ technology.added_by|capitalize }}</li>
            <li>Added on: {{ technology.added_on  }}</li>
          </ul>
        </div>
      </div>
    </div>

    <!--  Modal -->
    <div id="modal{{ technology._id }}" class="modal">
      <div class="modal-content">
        <h4>Are you sure you want to delete this item?</h4>
        <p>The entire entry and all its comments will be deleted and you will not be able to retrieve them</p>
      </div>
      <div class="modal-footer center-align">
        <a href="{{ url_for('delete_technology', technology_id=technology._id) }}"
          class="modal-close waves-effect waves-light btn-small purple lighten-1 align-right">Yes I am certain I want to
          delete this</a>
        <a href="{{ url_for('get_technologies', technology_id=technology._id) }}"
          class="modal-close waves-effect waves-light btn-small purple lighten-1 align-right">No, return to safety</a>
      </div>
    </div>
  </div>
</div>

<!-- Form to add a comment -->
<div class="row">
  <div class="col s12 center-align">
    <h4 class="heading">Add a comment about {{ technology.technology_name }}</h4>
  </div>
</div>
<div class="row card-panel">
  <form class="col s12 m8 offset-m2 " method="POST" action="{{ url_for('add_comment') }}">
    <div class="input-field col s12">
      <label for="technology_name">Technology</label>
      <input id="technology_name" type="text" name="technology_name" value="{{ technology.technology_name }}">
    </div>
    <div class="row">
      <div class="input-field col s12">
        <i class="material-icons prefix purple-text text-darken-3">comment</i>
        <label for="technology_comment">Your comments</label>
        <textarea id="technology_comment" name="technology_comment" minlength="10" maxlength="200"
          class="materialize-textarea validate" required></textarea>
      </div>
    </div>

    <!-- Reset Button -->
    <div class="row card-action center-align">
      <div class="col s6">
        <!--Submit Button-->
        <button type="submit" class="btn-large waves-effect waves-light purple lighten-1"><i
            class="material-icons prefix">forward</i>Submit</button>
      </div>
      <div class="col s6">
        <button type="reset" class="btn-large waves-effect waves-light purple lighten-1">
          <i class="material-icons prefix">refresh</i>Clear
        </button>
      </div>
    </div>
  </form>
</div>

<!-- Comments section-->
<div class="row">
  <div class="col s12 center-align">
    <h3>Comments</h3>
  </div>
</div>

<!-- Comments on this technology -->
{% for comment in comments if comment.technology_name == technology.technology_name %}
<div class="row">
  <div class="col s12">
    <div class="card">
      <div class="card-content ">
        <h4 class="card-title">{{ comment.technology_name }}</h4>
        <p>{{ comment.technology_comment }}</p>
        <p><em>Added by: {{ comment.author|capitalize }}</em></p>
        <p><em>Added on: {{ comment.created_on }}</em></p>
      </div>
    </div>
  </div>
</div>
{% else %}

<!-- If no comments -->
<div class="row">
  <div class="col s12 center-align">
    <h4>No one has added a comment yet - you can be the first!</h4>
    <button class="btn-large waves-effect waves-light purple lighten-1 tooltipped" data-position="top" data-tooltip="You can add comments from the technology's card"><a class="white-text" href="{{ url_for('get_technologies') }}" >Add the first comment<i
      class="material-icons prefix">add_circle_outline</i></a></button>
  </div>
</div>
{% endfor %}

<!-- Back to technologies page -->
<div class="row">
  <div class="col s12 center-align">
<a href="{{ url_for('get_technologies') }}" class="btn-large waves-effect waves-light purple lighten-1 " >Go back and
      browse all the technologies</a>
    <br>
    <a class="btn-large purple lighten-1" href="#page-top">Back to top</a>
  </div>
</div>
</section>
{% endblock %}